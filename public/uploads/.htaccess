# Sécurisation du dossier uploads/documents
# Empêche l'accès direct aux fichiers

# Désactiver l'exécution de scripts
Options -ExecCGI
AddHandler cgi-script .php .pl .py .jsp .asp .sh .cgi

# Empêcher l'accès direct aux fichiers
<Files "*">
    Order Deny,Allow
    Deny from all
</Files>

# Autoriser seulement les fichiers spécifiques si nécessaire
# <Files "*.pdf">
#     Order Allow,Deny
#     Allow from all
# </Files>

# Désactiver l'affichage du contenu du répertoire
Options -Indexes

# Empêcher l'accès aux fichiers de configuration
<FilesMatch "\.(htaccess|htpasswd|ini|log|sh|inc|bak)$">
    Order Deny,Allow
    Deny from all
</FilesMatch>

# Headers de sécurité
<IfModule mod_headers.c>
    Header always set X-Content-Type-Options nosniff
    Header always set X-Frame-Options DENY
    Header always set X-XSS-Protection "1; mode=block"
    Header always set Referrer-Policy "strict-origin-when-cross-origin"
</IfModule>

# Limiter les types de fichiers
<FilesMatch "\.(php|php3|php4|php5|phtml|pl|py|jsp|asp|sh|cgi)$">
    Order Deny,Allow
    Deny from all
</FilesMatch>
