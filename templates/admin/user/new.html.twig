{% extends 'base.html.twig' %}

{% block title %}Nouvel utilisateur - Administration{% endblock %}

{% block body %}
<div class="container-fluid">
    <div class="row">
        <div class="col-md-8">
            <div class="d-flex justify-content-between align-items-center mb-4">
                <h2>üë§ Nouvel utilisateur</h2>
                <a href="{{ path('app_admin_user_index') }}" class="btn btn-secondary">
                    <i class="bi bi-arrow-left"></i> Retour √† la liste
                </a>
            </div>

            <!-- Messages flash -->
            {% for flash_message in app.flashes('success') %}
                <div class="alert alert-success" role="alert">
                    {{ flash_message }}
                </div>
            {% endfor %}
            {% for flash_message in app.flashes('error') %}
                <div class="alert alert-danger" role="alert">
                    {{ flash_message }}
                </div>
            {% endfor %}

            <!-- Formulaire -->
            <div class="card">
                <div class="card-header">
                    <h5 class="card-title mb-0">Informations de l'utilisateur</h5>
                </div>
                <div class="card-body">
                    {{ form_start(form) }}

                    <div class="row">
                        <div class="col-md-6">
                            <div class="mb-3">
                                {{ form_label(form.email) }}
                                {{ form_widget(form.email, {'attr': {'class': 'form-control'}}) }}
                                {{ form_errors(form.email) }}
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="mb-3">
                                {{ form_label(form.password) }}
                                {{ form_widget(form.password, {'attr': {'class': 'form-control'}}) }}
                                {{ form_errors(form.password) }}
                                <small class="form-text text-muted">Le mot de passe doit contenir au moins 8 caract√®res.</small>
                            </div>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-md-6">
                            <div class="mb-3">
                                {{ form_label(form.firstName) }}
                                {{ form_widget(form.firstName, {'attr': {'class': 'form-control'}}) }}
                                {{ form_errors(form.firstName) }}
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="mb-3">
                                {{ form_label(form.lastName) }}
                                {{ form_widget(form.lastName, {'attr': {'class': 'form-control'}}) }}
                                {{ form_errors(form.lastName) }}
                            </div>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-md-6">
                            <div class="mb-3">
                                {{ form_label(form.phone) }}
                                {{ form_widget(form.phone, {'attr': {'class': 'form-control'}}) }}
                                {{ form_errors(form.phone) }}
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="mb-3">
                                {{ form_label(form.mobilePhone) }}
                                {{ form_widget(form.mobilePhone, {'attr': {'class': 'form-control'}}) }}
                                {{ form_errors(form.mobilePhone) }}
                            </div>
                        </div>
                    </div>

                    <div class="mb-3">
                        {{ form_label(form.address) }}
                        {{ form_widget(form.address, {'attr': {'class': 'form-control'}}) }}
                        {{ form_errors(form.address) }}
                    </div>

                    <div class="row">
                        <div class="col-md-6">
                            <div class="mb-3">
                                {{ form_label(form.city) }}
                                {{ form_widget(form.city, {'attr': {'class': 'form-control'}}) }}
                                {{ form_errors(form.city) }}
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="mb-3">
                                {{ form_label(form.postalCode) }}
                                {{ form_widget(form.postalCode, {'attr': {'class': 'form-control'}}) }}
                                {{ form_errors(form.postalCode) }}
                            </div>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-md-6">
                            <div class="mb-3">
                                {{ form_label(form.birthDate) }}
                                {{ form_widget(form.birthDate, {'attr': {'class': 'form-control'}}) }}
                                {{ form_errors(form.birthDate) }}
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="mb-3">
                                {{ form_label(form.isActive) }}
                                <div class="form-check">
                                    {{ form_widget(form.isActive, {'attr': {'class': 'form-check-input'}}) }}
                                    {{ form_label(form.isActive, null, {'label_attr': {'class': 'form-check-label'}}) }}
                                </div>
                                {{ form_errors(form.isActive) }}
                            </div>
                        </div>
                    </div>

                    <hr>

                    <div class="row">
                        {% if form.organization is defined %}
                        <div class="col-md-6">
                            <div class="mb-3">
                                {{ form_label(form.organization) }}
                                {{ form_widget(form.organization, {'attr': {'class': 'form-control'}}) }}
                                {{ form_errors(form.organization) }}
                            </div>
                        </div>
                        {% endif %}
                        {% if form.company is defined %}
                        <div class="col-md-6">
                            <div class="mb-3">
                                {{ form_label(form.company) }}
                                {{ form_widget(form.company, {'attr': {'class': 'form-control'}}) }}
                                {{ form_errors(form.company) }}
                            </div>
                        </div>
                        {% endif %}
                    </div>

                    <div class="mb-3">
                        {{ form_label(form.roles) }}
                        <div class="row">
                            {% for child in form.roles %}
                                <div class="col-md-6">
                                    <div class="form-check">
                                        {{ form_widget(child, {'attr': {'class': 'form-check-input'}}) }}
                                        {{ form_label(child, null, {'label_attr': {'class': 'form-check-label'}}) }}
                                    </div>
                                </div>
                            {% endfor %}
                        </div>
                        {{ form_errors(form.roles) }}
                        <small class="form-text text-muted">S√©lectionnez un ou plusieurs r√¥les pour l'utilisateur.</small>
                    </div>

                    <div class="d-flex justify-content-between">
                        <a href="{{ path('app_admin_user_index') }}" class="btn btn-secondary">
                            <i class="bi bi-arrow-left"></i> Annuler
                        </a>
                        <button type="submit" class="btn btn-primary">
                            <i class="bi bi-save"></i> Cr√©er l'utilisateur
                        </button>
                    </div>

                    {{ form_end(form) }}
                </div>
            </div>
        </div>

        <div class="col-md-4">
            <!-- Aide -->
            <div class="card">
                <div class="card-header">
                    <h5 class="card-title mb-0">üí° Aide</h5>
                </div>
                <div class="card-body">
                    <h6>R√¥les disponibles :</h6>
                    <ul class="list-unstyled">
                        <li><span class="badge bg-secondary me-1">USER</span> Utilisateur standard</li>
                        <li><span class="badge bg-info me-1">TENANT</span> Locataire</li>
                        <li><span class="badge bg-warning me-1">MANAGER</span> Gestionnaire</li>
                        <li><span class="badge bg-primary me-1">ADMIN</span> Administrateur</li>
                        <li><span class="badge bg-danger me-1">SUPER_ADMIN</span> Super administrateur</li>
                    </ul>

                    <hr>

                    <h6>Organisation/Soci√©t√© :</h6>
                    <p class="small text-muted">
                        L'organisation et la soci√©t√© d√©terminent l'acc√®s de l'utilisateur aux donn√©es.
                        Les utilisateurs ne peuvent voir que les donn√©es de leur organisation/soci√©t√©.
                    </p>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}
